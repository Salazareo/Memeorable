<!DOCTYPE html>

<html lang="en">

<head>
  <!-- Webpage Title -->
  <title>Password Reset - MEMEORABLE</title>
  <!-- Website META data -->
  <meta property="og:image" content="https://www.memeorable.xyz/assets/img/avatar/avatar-white.jpg">
  <meta property="og:image:width" content="600">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- Google Fonts -->
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>
  <script>
    WebFont.load({
      google: {
        "families": ["Montserrat:400,500,600,700", "Noto+Sans:400,700"]
      },
      active: function () {
        sessionStorage.fonts = true;
      }
    });
  </script>

  <!-- Favicon -->
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicon/favicon-16x16.png">

  <!-- (CSS) Stylesheet -->
  <link rel="stylesheet" href="./assets/css/bootstrap-4.0.0.css">
  <link rel="stylesheet" href="./assets/css/preloader.css">
  <link rel="stylesheet" href="./assets/css/elisyam-1.5.css">
  <link rel="stylesheet" href="./assets/css/custom.css">
  <link rel="stylesheet" href="./assets/css/animate/animate.min.css">

  <!-- Javascript (JS) Scripts -->
  <script src="/assets/js/jquery.min.js"></script>
  <script src="/assets/js/popper.min.js"></script>
  <script src="/assets/js/bootstrap-4.0.0.js"></script>
  <script src="assets/js/angular.min.js"></script>
  <script src="/assets/js/crypto-js.min.js"></script>


</head>

<body class="bg-white">
  <!-- Begin Preloader -->
  <div id="preloader">
    <div class="canvas">
      <img src="/assets/img/brand/memeorable_red.png" alt="logo" class="loader-logo">
      <div class="spinner"></div>
    </div>
  </div>
  <!-- End Preloader -->
  <!-- Begin Container -->
  <div class="container-fluid no-padding h-100" id="content">
    <div class="row flex-row h-100 bg-white">
      <!-- Begin Left Content -->
      <div class="col-xl-8 col-lg-6 col-md-5 no-padding">
        <div class="elisyam-bg login-bg">
          <!-- Background -->
          <div class="elisyam-overlay overlay-08"></div> <!-- Overlay BG colour -->
          <div class="authentication-col-content mx-auto">
            <!-- Content Area -->
            <img src="/assets/img/brand/memeorable_white.png" class="login-logo">
            <h1 class="gradient-text-01 title-text">Ready to get started?</h1>
            <!-- <span class="description"><b>The central hub of memes</b>
              <br>Browse. Create. Share. Compete.</span> -->
          </div>
        </div>
      </div>
      <!-- End Left Content -->

      <!-- Begin Right Content -->
      <div class="col-xl-4 col-lg-6 col-md-7 my-auto no-padding">
        <!-- Begin Form -->
        <div class="authentication-form mx-auto">
          <!-- <div class="logo-centered">
            <img src="/assets/img/brand/memeorable_red.png" alt="logo">
          </div> -->
          <h3>Reset Password</h3>
          <form>
            <div class="group material-input">
              <input type="password" name="password" REQUIRED id="password">
              <span class="highlight"></span>
              <span class="bar"></span>
              <label>New Password</label>
            </div>
            <div class="group material-input">
              <input type="password" name="confirm_password" REQUIRED id="con_password">
              <span class="highlight"></span>
              <span class="bar"></span>
              <label>Confirm New Password</label>
            </div>
          </form>
          <div class="sign-btn text-center">
            <a class="btn btn-lg btn-gradient-01" onclick="resetPassword()">Reset Password</a>
            <script>
              function resetPassword() {
                if (document.getElementById("con_password").value === document.getElementById("password").value &&
                  document.getElementById("password").value.length >= 4) {
                  var uhttp = new XMLHttpRequest();
                  var temp = window.location.href.substring(window.location.href.lastIndexOf('/') + 1);
                  uhttp.open("GET", "http://" + window.location.host + "/api/user/" + temp);
                  uhttp.send();
                  uhttp.onload = () => {
                    console.log("fuck");
                    if (uhttp.status != 200) {
                      alert("Something bad happened");
                    } else {
                      var user = JSON.parse(uhttp.responseText);
                      console.log(uhttp.responseText);
                      var xhttp = new XMLHttpRequest();
                      xhttp.open("POST", window.location.href);
                      xhttp.onload = () => {
                        if (xhttp.status != 200) {
                          alert("Password failed to reset, please try again later");
                        } else {
                          // please fix this someone that knows front end
                          window.location.href = "/login.html";
                        }
                      }
                      xhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
                      xhttp.send(JSON.stringify({
                        "password": CryptoJS.SHA256(document.getElementById("password").value, user).toString()
                      }));
                    }
                  }
                } else {
                  alert("Passwords do not match, or length is not greater than or equal to 4 characters");
                }
              }
            </script>
          </div>
          <div class="register">Already have an account? <br> <a href="../../../login.html">Sign In</a></div>
        </div>
        <!-- End Form -->
      </div>
      <!-- End Right Content -->


    </div>
    <!-- End Row -->
  </div>
  <!-- End Container -->
  <!-- Start of Terms and Conditions Modal -->
  <div id="scroll-modal" class="modal fade" tabindex="-1" role="dialog" style="display: none;" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Registration Terms and Conditions</h4>
          <button type="button" class="close" data-dismiss="modal">
            <span aria-hidden="true">Ã—</span>
            <span class="sr-only">close</span>
          </button>
        </div>
        <div class="modal-body">
          <p>
            <b>MEMEORABLE won't be possible without its users and community.
              <br>
              In order to register for an account, you must agree to the registration terms and conditions.
            </b>
          </p>
          <hr>
          <p>
            The MEMEORABLE User Agreement ("Terms") applies to your access to and use of the websites, mobile apps, and
            other online services (collectively, the "Services") that are used by MEMEORABLE ("MEMORABLE," "we," or
            "us").
          </p>
          <p>
            We encourage users to share their spectacular creations but we will maintain rules to ensure the safety of
            our users while keeping this place fun and entertaining.
            By accessing or using our Services, you agree to be bound by these Terms. If you do not agree to these
            Terms, you may not access or use our Services.
          </p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-shadow" data-dismiss="modal">
            Close
          </button>
        </div>
      </div>
    </div>
  </div>
  <!-- End of Terms and Conditions Modal -->>
  <!-- Begin Vendor Js -->
  <script src="/assets/vendors/js/base/jquery.min.js"></script>
  <script src="/assets/vendors/js/base/core.min.js"></script>
  <!-- End Vendor Js -->
  <!-- Begin Page Vendor Js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.nicescroll/3.6.8-fix/jquery.nicescroll.min.js"></script>
  <script src="../node_modules/angular-nicescroll/angular-nicescroll.js"></script>
  <script src="/assets/vendors/js/app/app.min.js"></script>
  <!-- End Page Vendor Js -->
</body>

</html>